---
layout: post
title: "Diffusion 만들기 2"
category: 만들기
---

# 서론

일단 부딛혀보자.

# Loss의 골치아픈 Term

Loss에서 다른 부분은 대충 어떻게 해야할지 감이 오는데... q(x\_t-1|x\_t,x\_0)은 어떻게 하지?

분명 [내가 지금 보고 있는 사이트](https://developers-shack.tistory.com/8)에도 설명이 있긴 하지만 알파라던가 하는 알 수 없는 수가 나온다.

결국 [원본 논문](https://arxiv.org/pdf/2006.11239.pdf)을 꺼냈다.

아 참, 이거 확률 모델이다 보니까 VAE에 있었던 그 거 (평균과 표준편차를 구한 다음에 그걸로 계산하는 것)를 하는게 맞다.

논문에 이것 저것 설명이 친절하게 되어 있는게 아닐까 싶다.

노이즈 입실론을 학습하도록 어떻게 잘 변형하는 내용도 있기는 한데... 일단은 그 부분은 넘어가자.

뭔가 엄청 삐걱거릴 것 같은 코드가 완성됐다.

이걸 이렇게 하는지 확신도 없고 뭣도 없지만...

# 다음 시간

이게 제대로 돌아가는지는 다음 시간에 확인해보자.
