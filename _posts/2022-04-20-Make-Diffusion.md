---
layout: post
title: "Diffusion 만들기"
category: 만들기
---

# 서론

이전에 말한대로 Diffusion model을 만들어보자.

# 신경망 구조는?

일단 한 시간 동안은 파이썬 가지고 놀면서 diffusion을 넣는 코드를 만든 것 같은 기분이다.

한 번은 미쳤다고 이미지 train셋 전체에 diffusion을 넣으려 했는데...

말이 diffusion을 넣는거지 실제로는 대략 500개의 체인을 거쳐서 그 중간까지 전부 저장하게 해뒀으니

메모리가 폭발하려고 하기 직전에 겨우 멈춰세우는데 성공했다.

물론 그 정보가 필요하기는 하지만 학습 중에 능동적으로 만들어 사용하기로 하자.

뭐 그건 그렇다고 치고, 중요한 것.

신경망의 구조는 어떻게 하고, 학습 하이퍼파라미터는 어떻게 하는가?

인터넷에서 찾아본 모델은 unet이라는 구조를 쓰고 있었다.

예전에 대충 알아본 적이 있다. 다만 mnist가 엄청 작은 이미지다 보니까... 인터넷에 mnist용으로 만든 unet을 보고 만들어보자.

# 다음 시간

일단 모델을 어떻게 할지는 정했으니 선을 연결하는 작업을 하자.

이래놓고 이게 제대로 돌아갈지는 미지수지만...
